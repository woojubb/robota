# 코드 개선 체크리스트

## 📋 전체 개요
`packages/` 폴더 내 각 패키지의 코드 품질 개선을 위한 체크리스트입니다. 단일 책임 원칙, 순수 함수 활용, 클래스 캡슐화, 코드 간결성을 중심으로 분석했습니다.

---

## 🏗️ packages/core - 핵심 패키지

### 🎯 robota.ts (메인 클래스)
- [ ] **Facade 패턴 적용**
  - [ ] 핵심 메서드(run, runStream, close)만 Robota 클래스에 유지
  - [ ] 기능별 매니저를 readonly 프로퍼티로 노출 (ai, system, functions, analytics, tools, conversation)
  - [ ] 복잡한 설정 메서드들을 각 매니저로 위임

- [ ] **인터페이스 분리 원칙 적용**
  - [ ] RobotaCore 인터페이스: 핵심 실행 기능만 포함
  - [ ] RobotaConfigurable 인터페이스: 설정 관련 기능만 포함
  - [ ] 클라이언트가 필요한 기능만 의존하도록 인터페이스 분리

- [ ] **클래스 단순화**
  - [ ] `SimpleConversationHistory`와 `PersistentSystemConversationHistory`의 코드 중복
  - [ ] 공통 로직을 추상 클래스로 추출
  - [ ] 상속보다는 컴포지션 패턴 고려

---

## 📚 전체 프로젝트 공통 개선사항

### 📖 **TSDoc 주석 최적화 (모든 클래스)**
- [ ] **상세한 예제들을 별도 examples/ 폴더로 분리**
  - [ ] packages/core 내 모든 클래스
  - [ ] packages/tools 내 모든 클래스  
  - [ ] packages/sessions 내 모든 클래스
  - [ ] packages/openai, packages/anthropic, packages/google 내 모든 클래스
- [ ] **@see 태그 활용으로 중복 설명 제거**
  - [ ] 관련 클래스/메서드 간 상호 참조 링크 추가
  - [ ] 공통 개념에 대한 중복 설명 제거
- [ ] **핵심 정보(@param, @returns, @throws)만 유지하여 파일 크기 30-40% 감소**
  - [ ] 장황한 설명을 간결하게 정리
  - [ ] 필수 정보만 유지하고 부가 설명은 examples/로 이동

---

## 공통
- [x] AI Provider의 packages/openai packages/anthropic packages/google 는 유사한 구조를 가져야 합니다.

## 🛠️ packages/tools - 도구 관리

### ⚙️ function.ts
- [ ] **거대한 파일 분해**
  - [ ] 441줄의 파일을 기능별로 분리
  - [ ] Zod 스키마 변환 로직을 별도 모듈로
  - [ ] Function Registry를 별도 클래스로

- [ ] **순수 함수 최적화**
  - [ ] `zodToJsonSchema()` 함수의 복잡성 줄이기
  - [ ] 타입 변환 로직들을 작은 순수 함수들로 분해
  - [ ] 재귀 호출 최적화

- [ ] **에러 처리 강화**
  - [ ] console.warn 대신 적절한 에러 처리
  - [ ] 타입 안전성 개선

### 🔧 기타 tool provider들
- [ ] **공통 인터페이스 추상화**
  - [ ] 각 tool provider들의 공통 로직 추출
  - [ ] 팩토리 패턴 적용 고려

---

## 💬 packages/sessions - 세션 관리

### 🎮 session-impl.ts
- [ ] **상태 관리 로직 개선**
  - [ ] 세션 상태 변경을 상태 머신 패턴으로
  - [ ] 상태 전환 로직을 순수 함수로 분리

- [ ] **에러 메시지 개선**
  - [ ] 하드코딩된 한국어 메시지들을 상수로 분리
  - [ ] 일관된 에러 처리 패턴 적용

- [ ] **메모리 관리**
  - [ ] Map을 사용한 채팅 관리의 메모리 효율성 개선
  - [ ] 채팅 수 제한 로직을 더 명확하게

---

## 🚀 우선순위별 개선 계획

### 🟢 낮은 우선순위
1. [ ] **i18n 시스템** - 다국어 지원
2. [ ] **성능 최적화** - 메모리 사용량 개선
3. [ ] **문서화** - JSDoc 개선

---

## 🎯 설계 원칙 준수 체크

### ✅ 단일 책임 원칙 (SRP)
- [x] 각 클래스가 하나의 명확한 책임만 가지도록
- [x] 거대한 클래스들을 역할별로 분리

### ✅ 순수 함수 활용
- [x] 사이드 이펙트가 없는 함수들로 변환
- [x] 예측 가능하고 테스트하기 쉬운 코드

### ✅ 캡슐화 강화
- [x] 클래스 내부 상태를 외부에서 직접 조작하지 못하도록
- [x] 고수준 메서드만 외부에 노출

### ✅ 코드 간결성
- [x] 복잡한 조건문과 중첩을 줄이기
- [x] 명확하고 이해하기 쉬운 코드 구조

---

## 📝 참고사항

- 모든 개선사항은 기존 API 호환성을 유지하면서 진행
- 테스트 코드를 함께 개선하여 리팩토링 안정성 확보
- 점진적 개선을 통해 시스템 안정성 유지 

## ✅ 완료 현황 요약

### 🔄 다음 단계 (중간/낮은 우선순위)
1. **packages/tools** - function.ts 파일 분해 및 순수 함수 최적화
2. **packages/sessions** - 상태 관리 로직 개선
3. **packages/core** - conversation-history 클래스 단순화
4. **성능 최적화** - 메모리 사용량 개선
5. **i18n 시스템** - 다국어 지원 구현
