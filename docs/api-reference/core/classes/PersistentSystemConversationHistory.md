<!-- 
 ⚠️  AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
 This file is automatically generated by scripts/docs-generator.js
 To make changes, edit the source TypeScript files or update the generator script
-->

[core](../../) / [Exports](../modules) / PersistentSystemConversationHistory

# Class: PersistentSystemConversationHistory

Conversation history implementation that maintains system messages

Extends SimpleConversationHistory with automatic system prompt management.
The system prompt is automatically maintained and can be updated dynamically.

**`See`**

../../apps/examples/04-sessions | Session and Conversation Examples

## Hierarchy

- `BaseConversationHistory`

  ↳ **`PersistentSystemConversationHistory`**

## Table of contents

### Constructors

- [constructor](PersistentSystemConversationHistory#constructor)

### Methods

- [addUserMessage](PersistentSystemConversationHistory#addusermessage)
- [addAssistantMessage](PersistentSystemConversationHistory#addassistantmessage)
- [addSystemMessage](PersistentSystemConversationHistory#addsystemmessage)
- [addToolMessageWithId](PersistentSystemConversationHistory#addtoolmessagewithid)
- [getMessagesByRole](PersistentSystemConversationHistory#getmessagesbyrole)
- [getRecentMessages](PersistentSystemConversationHistory#getrecentmessages)
- [addMessage](PersistentSystemConversationHistory#addmessage)
- [getMessages](PersistentSystemConversationHistory#getmessages)
- [getMessageCount](PersistentSystemConversationHistory#getmessagecount)
- [clear](PersistentSystemConversationHistory#clear)
- [updateSystemPrompt](PersistentSystemConversationHistory#updatesystemprompt)
- [getSystemPrompt](PersistentSystemConversationHistory#getsystemprompt)

## Constructors

### constructor

• **new PersistentSystemConversationHistory**(`systemPrompt`, `options?`): [`PersistentSystemConversationHistory`](PersistentSystemConversationHistory)

Create a new PersistentSystemConversationHistory instance

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `systemPrompt` | `string` | Initial system prompt to set |
| `options?` | `Object` | Configuration options passed to underlying SimpleConversationHistory |
| `options.maxMessages?` | `number` | - |

#### Returns

[`PersistentSystemConversationHistory`](PersistentSystemConversationHistory)

#### Overrides

BaseConversationHistory.constructor

#### Defined in

[packages/core/src/conversation-history.ts:542](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L542)

## Methods

### addUserMessage

▸ **addUserMessage**(`content`, `metadata?`): `void`

#### Parameters

| Name | Type |
| :------ | :------ |
| `content` | `string` |
| `metadata?` | `Record`\<`string`, `any`\> |

#### Returns

`void`

#### Inherited from

BaseConversationHistory.addUserMessage

#### Defined in

[packages/core/src/conversation-history.ts:375](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L375)

___

### addAssistantMessage

▸ **addAssistantMessage**(`content`, `toolCalls?`, `metadata?`): `void`

#### Parameters

| Name | Type |
| :------ | :------ |
| `content` | `string` |
| `toolCalls?` | \{ `id`: `string` ; `type`: ``"function"`` ; `function`: \{ `name`: `string` ; `arguments`: `string`  }  }[] |
| `metadata?` | `Record`\<`string`, `any`\> |

#### Returns

`void`

#### Inherited from

BaseConversationHistory.addAssistantMessage

#### Defined in

[packages/core/src/conversation-history.ts:380](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L380)

___

### addSystemMessage

▸ **addSystemMessage**(`content`, `metadata?`): `void`

#### Parameters

| Name | Type |
| :------ | :------ |
| `content` | `string` |
| `metadata?` | `Record`\<`string`, `any`\> |

#### Returns

`void`

#### Inherited from

BaseConversationHistory.addSystemMessage

#### Defined in

[packages/core/src/conversation-history.ts:396](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L396)

___

### addToolMessageWithId

▸ **addToolMessageWithId**(`content`, `toolCallId`, `toolName`, `metadata?`): `void`

#### Parameters

| Name | Type |
| :------ | :------ |
| `content` | `string` |
| `toolCallId` | `string` |
| `toolName` | `string` |
| `metadata?` | `Record`\<`string`, `any`\> |

#### Returns

`void`

#### Inherited from

BaseConversationHistory.addToolMessageWithId

#### Defined in

[packages/core/src/conversation-history.ts:401](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L401)

___

### getMessagesByRole

▸ **getMessagesByRole**(`role`): [`UniversalMessage`](../modules#universalmessage)[]

#### Parameters

| Name | Type |
| :------ | :------ |
| `role` | [`UniversalMessageRole`](../modules#universalmessagerole) |

#### Returns

[`UniversalMessage`](../modules#universalmessage)[]

#### Inherited from

BaseConversationHistory.getMessagesByRole

#### Defined in

[packages/core/src/conversation-history.ts:410](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L410)

___

### getRecentMessages

▸ **getRecentMessages**(`count`): [`UniversalMessage`](../modules#universalmessage)[]

#### Parameters

| Name | Type |
| :------ | :------ |
| `count` | `number` |

#### Returns

[`UniversalMessage`](../modules#universalmessage)[]

#### Inherited from

BaseConversationHistory.getRecentMessages

#### Defined in

[packages/core/src/conversation-history.ts:414](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L414)

___

### addMessage

▸ **addMessage**(`message`): `void`

Add a message to conversation history (delegates to underlying history)

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `message` | [`UniversalMessage`](../modules#universalmessage) | Universal message to add |

#### Returns

`void`

#### Overrides

BaseConversationHistory.addMessage

#### Defined in

[packages/core/src/conversation-history.ts:556](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L556)

___

### getMessages

▸ **getMessages**(): [`UniversalMessage`](../modules#universalmessage)[]

Get all messages (delegates to underlying history)

#### Returns

[`UniversalMessage`](../modules#universalmessage)[]

Array of all messages including system messages

#### Overrides

BaseConversationHistory.getMessages

#### Defined in

[packages/core/src/conversation-history.ts:565](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L565)

___

### getMessageCount

▸ **getMessageCount**(): `number`

Get total message count (delegates to underlying history)

#### Returns

`number`

Total number of messages including system messages

#### Overrides

BaseConversationHistory.getMessageCount

#### Defined in

[packages/core/src/conversation-history.ts:574](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L574)

___

### clear

▸ **clear**(): `void`

Clear conversation history but preserve system prompt

Clears all messages and re-adds the current system prompt.

#### Returns

`void`

#### Overrides

BaseConversationHistory.clear

#### Defined in

[packages/core/src/conversation-history.ts:583](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L583)

___

### updateSystemPrompt

▸ **updateSystemPrompt**(`systemPrompt`): `void`

Update the system prompt and refresh system messages

Removes old system messages, updates the system prompt, and adds
the new system prompt as a system message.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `systemPrompt` | `string` | New system prompt to set |

#### Returns

`void`

#### Defined in

[packages/core/src/conversation-history.ts:596](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L596)

___

### getSystemPrompt

▸ **getSystemPrompt**(): `string`

Get the current system prompt

#### Returns

`string`

Current system prompt string

#### Defined in

[packages/core/src/conversation-history.ts:616](https://github.com/woojubb/robota/blob/311ad65650a7614cc67978c0c1650e33abba7a82/packages/core/src/conversation-history.ts#L616)
